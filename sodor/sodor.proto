syntax = "proto3";

option go_package = "github.com/BabySid/proto/sodor";

service FatController {
  rpc CreateJob (Job) returns (JobReply) {}
}

message JobReply {
  int64 id = 1;
}

enum TaskState {
  TS_INIT = 0;
  TS_RUNNING = 1;
  TS_STOPPED = 2;
}

enum SchedulerMode {
  SM_None = 0;
  SM_Crontab = 1;
}

message RoutineSpec {
  string ct_spec = 1;
}

message Task {
  int64  id = 1;
  int64 create_at = 2;
  int64 update_at = 3;
  int64 job_id = 4;
  string name = 5;
  string running_hosts = 6;
  SchedulerMode scheduler_mode = 7;
  RoutineSpec routine_spec = 8;
  string script = 9;
  int32 running_timeout = 10;
}

message Job {
  int64  id = 1;
  int64 create_at = 2;
  int64 update_at = 3;
  string name = 4;
  repeated Task tasks = 5;
  repeated TaskRelation relations = 6;
}

enum ConditionType {
  CT_ExitCode = 0;
}
message TaskRelation {
  string pre_task = 1;
  string post_task = 2;
  string cur_task = 3;
  ConditionType condition_type = 4;
}

message AlertGroup {
  int64  id = 1;
  int64 create_at = 2;
  int64 update_at = 3;
  string name = 4;
  repeated int64 plugin_ids = 5;
}

message AlertPluginParam {

}

message AlertPlugin {
  int64  id = 1;
  int64 create_at = 2;
  int64 update_at = 3;
  string catalog = 4;
  AlertPluginParam params = 5;
}

message AlertHistory {
  int64  id = 1;
  int64 create_at = 2;
  int64 update_at = 3;
}